{% import "macros.html" as macros %}
{% import "macros/dashboard.html" as dashboard %}
{% import "macros/graphs.html" as graphs %}
{% extends "base.html" %}

{% block extra_css %}<link rel="stylesheet" type="text/css" href="/css/dashboard.css">{% endblock %}

{% block body_content %}
<span title="enter a comma separated list of tags to search on" style="padding-bottom: 1em;">
<label for="tags_query">tag search: </label>
<input id="tags_query" class="label_input" type="text" size="50" value="dashboard" name="tags" onchange="LX.graphQuery()">
</span>

<div id="layout_controls">
  <label for="graph_width">graph width:</label>
  <input id="graph_width" type="text" size=4 maxlength=4 value="{{prefs.small_width}}"
         onchange="LX.dashboard.redraw_graphs(parseInt(this.value))" >
</div>
<div id="query_results" class="row_container">
  {{ graphs.draw_graphs(dashboard_graphs, width=prefs.small_width) }}
</div> <!-- query_results -->

<div style="clear: both">
  <h2>add a new dataset</h2>
  <form action="/new/dataset" method="POST">
    <fieldset>
      <legend>dataset details</legend>
      {{ macros.label_with_input("dataset name", "new_dataset_name", "dataset") }}
      {{ dashboard.aggregate_dropdown() }}
      <label for="group_dropdown">
      initial group:
      </label>
      <select id="group_dropdown" name="group">
        {% for group in groups %}
        <option>{{group.name}}</option>
        {% endfor %}
      </select>
      <br>
      <label for="tags_input">tags (comma separated): </label><input type="text" id="tags_input" name="tags" size=60><br>
      <label for="description_input">description: <br></label>
      <textarea name="description" id="description_input" cols=80 rows=3></textarea> <br>
    </fieldset>
    <fieldset>
      <legend>initial data series</legend>
      {{ macros.label_with_input("interval (seconds)", "new_interval", "ds_interval") }}
      {{ macros.label_with_input("max age (seconds)", "new_maxage", "ds_maxage") }}
    </fieldset>
    <input type="submit" value="submit">
  </form>
</div>
{% endblock %}
